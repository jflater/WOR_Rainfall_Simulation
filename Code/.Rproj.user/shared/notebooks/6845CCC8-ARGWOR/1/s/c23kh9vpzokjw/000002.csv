"0","# To fix I need to make sure that s and w are the same, use setdiff and change the order of the arguments"
"0","setdiff(stds$Assay, WaterCT$Assay)"
"1","character(0)
"
"0","setdiff(WaterCT$Assay, stds$Assay)"
"1"," [1]"
"1"," ""erm(36)""     "
"1"," ""aac3-Via""    "
"1"," ""aadA17""      "
"1"," ""int1-a-marko"""
"1"," ""tnpA1""       "
"1"," ""tnpA2""       "
"1"," ""aadD""        "
"1","
"
"1"," [8]"
"1"," ""tnpA3""       "
"1"," ""lnuA""        "
"1"," ""aphA3""       "
"1"," ""tnpA5""       "
"1"," ""IS1247""      "
"1"," ""cadC""        "
"1"," ""tnpA6""       "
"1","
"
"1","[15]"
"1"," ""cmr""         "
"1"," ""tnpA7""       "
"1","
"
"0","s <- stds %>%"
"0","  drop_na(""counts"")"
"0",""
"0","w <- WaterCT %>%"
"0","  filter(!Assay %in% setdiff(WaterCT$Assay, stds$Assay))"
"0",""
"0","w <- w %>%"
"0","  select(plot, sample_number, treatment, Assay, Value, gene_class)"
"0",""
"0","setdiff(stds$Assay, w$Assay)"
"1","character(0)
"
"0","setdiff(w$Assay, stds$Assay)"
"1","character(0)
"
"0","dput(unique(w$Assay)) # Use this list for the next map function"
"1","c(""16S_Eub_338_518"", ""sul1"", ""tetW"", ""sul2"", ""erm(C)"", ""tetX"", 
"
"1","""tetbP"", ""aadA9"", ""tetG"", ""intI1F165_clinical"", ""tetH"", ""tetL"", 
"
"1","""tetM"", ""IS6100"", ""tetT"", ""strB"")
"
"0","# map this list of standards and counts to the biomark data to generate counts"
"0","normby16s <- c(""16S_Eub_338_518"", ""sul1"", ""tetW"", ""sul2"", ""erm(C)"", ""tetX"", "
"0","""tetbP"", ""aadA9"", ""tetG"", ""tetH"", ""tetL"", "
"0","""tetM"", ""IS6100"", ""tetT"", ""strB"") %>%"
"0","  map( ~ get_counts(s, w, gene = .x)) %>%"
"0","  reduce(full_join)"
"1","Joining, by = c(""plot"", ""sample_number"", ""treatment"", ""Assay"", ""Value"", ""gene_class"", ""counts"")
"
"1","Joining, by = c(""plot"", ""sample_number"", ""treatment"", ""Assay"", ""Value"", ""gene_class"", ""counts"")
"
"1","Joining, by = c(""plot"", ""sample_number"", ""treatment"", ""Assay"", ""Value"", ""gene_class"", ""counts"")
"
"1","Joining, by = c(""plot"", ""sample_number"", ""treatment"", ""Assay"", ""Value"", ""gene_class"", ""counts"")
"
"1","Joining, by = c(""plot"", ""sample_number"", ""treatment"", ""Assay"", ""Value"", ""gene_class"", ""counts"")
"
"1","Joining, by = c(""plot"", ""sample_number"", ""treatment"", ""Assay"", ""Value"", ""gene_class"", ""counts"")
"
"1","Joining, by = c(""plot"", ""sample_number"", ""treatment"", ""Assay"", ""Value"", ""gene_class"", ""counts"")
"
"1","Joining, by = c(""plot"", ""sample_number"", ""treatment"", ""Assay"", ""Value"", ""gene_class"", ""counts"")
"
"1","Joining, by = c(""plot"", ""sample_number"", ""treatment"", ""Assay"", ""Value"", ""gene_class"", ""counts"")
"
"1","Joining, by = c(""plot"", ""sample_number"", ""treatment"", ""Assay"", ""Value"", ""gene_class"", ""counts"")
"
"1","Joining, by = c(""plot"", ""sample_number"", ""treatment"", ""Assay"", ""Value"", ""gene_class"", ""counts"")
"
"1","Joining, by = c(""plot"", ""sample_number"", ""treatment"", ""Assay"", ""Value"", ""gene_class"", ""counts"")
"
"1","Joining, by = c(""plot"", ""sample_number"", ""treatment"", ""Assay"", ""Value"", ""gene_class"", ""counts"")
"
"1","Joining, by = c(""plot"", ""sample_number"", ""treatment"", ""Assay"", ""Value"", ""gene_class"", ""counts"")
"
"0","#saveRDS(normby16s, file = ""../data/WorArgBySixS.RDS"") # note these are not normalized by 16s, just counts from standard curves"
"0",""
"0","norm <- normby16s %>%"
"0","  unite(ID, c(""plot"", ""sample_number"", ""Assay""), sep = ""."", remove = F) %>%"
"0","  select(!Value) %>%"
"0","  dplyr::group_by(plot, sample_number, Assay) %>%"
"0","  dplyr::mutate(rep = seq_along(ID)) %>%"
"0","  select(plot, sample_number, rep, treatment, Assay, gene_class, counts) %>%"
"0","  ungroup()"
"0",""
"0","SixS <- norm %>%"
"0","  filter(Assay == ""16S_Eub_338_518"") %>%"
"0","  dplyr::rename(SixSCount = counts) %>%"
"0","  select(plot, sample_number, rep, SixSCount, treatment) "
"0",""
"0","dfdf <- norm %>%"
"0","  left_join(SixS, by = c(""plot"", ""sample_number"", ""rep"", ""treatment"")) %>%"
"0","  filter(!Assay == ""16S_Eub_338_518"")"
"0",""
"0","# Now got to divide each count of each gene by the 16s number"
"0",""
"0","test <- w %>% # Order ARGs based on class"
"0","  arrange(gene_class) "
"0",""
"0","levels <- dput(levels(factor(test$Assay))) # dput ftw!!!"
"1","c(""16S_Eub_338_518"", ""aadA9"", ""erm(C)"", ""intI1F165_clinical"", 
"
"1","""IS6100"", ""strB"", ""sul1"", ""sul2"", ""tetbP"", ""tetG"", ""tetH"", ""tetL"", 
"
"1","""tetM"", ""tetT"", ""tetW"", ""tetX"")
"
"0","dfdf$treatment = factor(dfdf$treatment, "
"0","                             levels = c('WCS', 'WCSM', 'WCM'))"
"0","dfdf$sample_number <- as.factor(dfdf$sample_number)"
"0","levels(dfdf$sample_number) <- list(""2.5"" = ""1"", ""7.5"" = ""2"", ""12.5"" = ""3"", ""17.5"" = ""4"", ""22.5"" = ""5"", ""27.5"" = ""6"")"
"0",""
"0",""
