"0","#+++++++++++++++++++++++++"
"0","# Function to calculate the mean and the standard deviation"
"0","  # for each group"
"0","#+++++++++++++++++++++++++"
"0","# data : a data frame"
"0","# varname : the name of a column containing the variable"
"0","  #to be summariezed"
"0","# groupnames : vector of column names to be used as"
"0","  # grouping variables"
"0",""
"0","data_summary <- function(data, varname, groupnames){"
"0","  require(plyr)"
"0","  summary_func <- function(x, col){"
"0","    c(mean = mean(x[[col]], na.rm=TRUE),"
"0","      sd = sd(x[[col]], na.rm=TRUE))"
"0","  }"
"0","  data_sum <- plyr::ddply(data, groupnames, .fun=summary_func,"
"0","                  varname)"
"0","  data_sum <- plyr::rename(data_sum, c(""mean"" = varname))"
"0"," return(data_sum)"
"0","}"
"0",""
"0","CT_BAR_PLOT <- function(df){"
"0","  plot <- df %>%"
"0","   filter(Call == ""Pass"") %>%"
"0","   data_summary(varname = ""Value"", groupnames = c(""Assay"")) %>%"
"0","   ggplot(aes(x = reorder(Assay, -Value), y = Value)) +"
"0","     geom_bar(stat=""identity"", color=""black"", "
"0","            position=position_dodge()) +"
"0","     geom_errorbar(aes(ymin=Value-sd, ymax=Value+sd), width=.2,"
"0","                  position=position_dodge(.9))  +"
"0","     theme_minimal() +"
"0","     theme(legend.position = ""none"") +"
"0","     coord_flip() +"
"0","     labs(y = ""Mean cycle time"", x = ""Assay"")"
"0","  return(plot)"
"0","}"
