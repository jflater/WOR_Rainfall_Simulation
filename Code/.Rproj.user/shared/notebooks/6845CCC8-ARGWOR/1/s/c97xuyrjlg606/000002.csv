"0","WaterCT <- water %>%"
"0","  filter(Sample_Name != ""Supply_Water"") %>% # Remove 16s for ARG plot"
"0","  select(Sample_Name, plot, sample_number, treatment, Assay, Value) "
"0",""
"0","WaterCT$Value <- as.numeric(WaterCT$Value) # Make numeric"
"0","max(WaterCT$Value[WaterCT$Value < 900])"
"1","[1]"
"1"," 28.99998"
"1","
"
"0","# The highest value less than 999 is 28.9, so changing everything above 30 to NA"
"0",""
"0","WaterCT$Value[WaterCT$Value > 30] <- NA # Change high CT"
"0",""
"0","WaterCT$Treatment_f = factor(WaterCT$treatment, "
"0","                            levels = c('WCS', 'WCSM', 'WCM'),"
"0","                            labels = c(""CS"", ""CSM"", ""CM"")) # Change order of factors, WCS is kinda like control"
"0",""
"0","unique(WaterCT$Assay)"
"1"," [1]"
"1"," ""16S_Eub_338_518""   "
"1"," ""sul1""              "
"1"," ""erm(36)""           "
"1"," ""tetW""              "
"1"," ""aac3-Via""          "
"1","
"
"1"," [6]"
"1"," ""sul2""              "
"1"," ""erm(C)""            "
"1"," ""tetX""              "
"1"," ""aadA17""            "
"1"," ""tetbP""             "
"1","
"
"1","[11]"
"1"," ""int1-a-marko""      "
"1"," ""tnpA1""             "
"1"," ""aadA9""             "
"1"," ""tetG""              "
"1"," ""intI1F165_clinical"""
"1","
"
"1","[16]"
"1"," ""tnpA2""             "
"1"," ""tetH""              "
"1"," ""aadD""              "
"1"," ""tnpA3""             "
"1"," ""lnuA""              "
"1","
"
"1","[21]"
"1"," ""tetL""              "
"1"," ""aphA3""             "
"1"," ""tnpA5""             "
"1"," ""IS1247""            "
"1"," ""tetM""              "
"1","
"
"1","[26]"
"1"," ""cadC""              "
"1"," ""tnpA6""             "
"1"," ""IS6100""            "
"1"," ""tetT""              "
"1"," ""cmr""               "
"1","
"
"1","[31]"
"1"," ""tnpA7""             "
"1"," ""strB""              "
"1","
"
"0","WaterCT <- WaterCT %>% # Add classes to ARGs"
"0","  mutate(gene_class = case_when(Assay %in% unique(WaterCT$Assay[grepl(""^[aa]"", WaterCT$Assay)]) ~ ""AMG"","
"0","                                Assay %in% unique(WaterCT$Assay[grepl(""^[erm]"", WaterCT$Assay)]) ~ ""MLSB"","
"0","                                Assay %in% unique(WaterCT$Assay[grepl(""^[sul]"", WaterCT$Assay)]) ~ ""Sulfa"","
"0","                                Assay %in% unique(WaterCT$Assay[grepl(""tet"", WaterCT$Assay)]) ~ ""Tet"","
"0","                                Assay %in% c(""intl1"", ""intl2"", ""intl3"", ""IS1247"", ""IS6100"", ""tnpA2"","
"0","                                              ""tnpA5"", ""tnpA6"", ""tnpA3"", ""intI1F165_clinical"", ""tnpA1"", ""int1-a-marko"", ""tnpA7"") ~ ""MGE"", "
"0","                                Assay %in% c(""cadC"", ""cmr"") ~ ""HM"","
"0","                                Assay == c(""16S_Eub_338_518"") ~ ""16S""))"
"0",""
"0","WaterCT$gene_class_f = factor(WaterCT$gene_class, # Order the classes"
"0","                                levels = c('AMG', 'MLSB', 'Sulfa', ""Tet"", ""MGE"", ""HM"", ""16S""))"
"0",""
"0","test <- WaterCT %>% # Order ARGs based on class"
"0","  arrange(gene_class) "
"0","  "
"0","levels <- dput(levels(factor(test$Assay))) # dput ftw!!!"
"1","c(""16S_Eub_338_518"", ""aac3-Via"", ""aadA17"", ""aadA9"", ""aadD"", ""aphA3"", 
"
"1","""cadC"", ""cmr"", ""erm(36)"", ""erm(C)"", ""int1-a-marko"", ""intI1F165_clinical"", 
"
"1","""IS1247"", ""IS6100"", ""lnuA"", ""strB"", ""sul1"", ""sul2"", ""tetbP"", 
"
"1","""tetG"", ""tetH"", ""tetL"", ""tetM"", ""tetT"", ""tetW"", ""tetX"", ""tnpA1"", 
"
"1","""tnpA2"", ""tnpA3"", ""tnpA5"", ""tnpA6"", ""tnpA7"")
"
"0","heatmap <- ggplot(WaterCT, aes(as.factor(sample_number), ordered(Assay, levels = levels))) +"
"0","  geom_tile(aes(fill = Value), colour = ""white"", size = 0.1) +"
"0","  scale_fill_viridis(name = ""Gene CT"", option = ""plasma"")  +"
"0","  labs(x = ""Sample Time (min)"", y = ""Gene"") +"
"0","  facet_nested(gene_class_f ~ Treatment_f + plot, scales = ""free"", space = ""free"") + theme_classic() +"
"0","  theme("
"0","    legend.background = element_rect("
"0","      fill = (alpha = 0),"
"0","      color = 'black',"
"0","      size = 0.1),"
"0","    panel.background = element_rect(color = 'black', size = 1.4),"
"0","    strip.text.x = element_text(size = 10, face = 'bold'),"
"0","    strip.background = element_rect(colour = 'black', size = 1.4)"
"0","  )  +"
"0","  scale_y_discrete("
"0","    name = NULL,"
"0","    labels = labels"
"0","  ) +"
"0","  theme("
"0","    axis.text.y = element_markdown(color = ""black"", size = 11)"
"0","  ) "
"0","heatmap"
