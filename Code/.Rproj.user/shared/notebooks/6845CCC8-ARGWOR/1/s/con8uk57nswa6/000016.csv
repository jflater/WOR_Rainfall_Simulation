"0",""
"0","levels(waterdata$treatment) <- list(""CS"" = ""WCS"", ""CSM"" = ""WCSM"", ""CM"" = ""WCM"")"
"0",""
"0","heatmap2 <- ggplot(waterdata, aes(as.factor(sample_number), ordered(Assay, levels = levels))) +"
"0","  geom_tile(aes(fill = norm), colour = ""white"", size = 0.1) +"
"0","  scale_fill_viridis(name = ""ARG count \nnormalized by 16S"")  +"
"0","  labs(x = ""Sample time (min) after runoff"", y = ""ARG"") +"
"0","  facet_nested(gene_class ~ treatment + plot, scales = ""free"", space = ""free"") + theme_classic() +"
"0","  theme("
"0","    text = element_text(size = 12, family = ""Times""),"
"0","    panel.background = element_rect(color = 'black', size = 1.4),"
"0","    strip.text.x = element_text(size = 10, face = 'bold'),"
"0","    strip.background = element_rect(colour = 'black', size = 1.4),"
"0","    axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),"
"0","    legend.position = ""top"","
"0","    legend.key.width = unit(.75, ""in"")"
"0","  ) "
"0",""
"0","heatmap2  +"
"0","  scale_y_discrete("
"0","    name = NULL,"
"0","    labels = labels"
"0","  ) +"
"0","  theme("
"0","    axis.text.y = element_markdown()"
"0","  )"
