"0","pwboxwithstats <- function(df, assay){"
"0","    # Welch One way ANOVA test"
"0","    test <- filter(df, Assay == assay)"
"0","    res.aov2 <- test %>% "
"0","      group_by(Assay) %>%"
"0","      kruskal_test(norm ~ treatment)"
"0","    res.aov2"
"0","    # Pairwise comparisons (Games-Howell)"
"0","    pwc2 <- test %>% "
"0","      group_by(Assay) %>%"
"0","      dunn_test(norm ~ treatment)"
"0","    pwc2"
"0","    # Visualization: box plots with p-values"
"0","    pwc2 <- pwc2 %>% add_xy_position(x = ""treatment"", step.increase = .1)"
"0","    p <- ggboxplot(test, x = ""treatment"", y = ""norm"") +"
"0","      stat_pvalue_manual(pwc2, hide.ns = TRUE) +"
"0","      labs("
"0","        title = paste0(test$Assay,"" concentration in runoffwater, normalized by 16S""),"
"0","        subtitle = get_test_label(res.aov2, detailed = TRUE),"
"0","        caption = get_pwc_label(pwc2)"
"0","        ) "
"0","    return(p)"
"0","}"
"0",""
"0","pwboxwithstats(test, ""tetL"")"
